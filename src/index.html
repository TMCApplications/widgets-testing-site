<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Widgets test</title>
    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.3.5/dist/alpine.min.js" defer></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
</head>
<body>
    <div class="grid grid-cols-4 h-screen" x-data="getData()">
        <div class="col-span-1 border-r-4 grid grid-cols-1 p-2 pb-0 overflow-auto">
            <template x-for="client in clients">
                <div class="border-4 shadow-sm p-2 mb-2 text-center">
                    <div class="text-lg mb-2" x-text="client.name + ' (' + client.code + ')'"></div>
                    <div class="grid grid-cols-1" x-bind:class="{
                        'xl:grid-cols-3' : client.widgets.length == 3,
                        'lg:grid-cols-2' : client.widgets.length == 2,
                    }">
                        <template x-for="widget in client.widgets">
                            <div class="mb-2">
                                <button
                                    class="text-white text-xs font-semibold py-1 px-2 border rounded shadow h-full"
                                    :class="widget.classes"
                                    x-text="widget.name"
                                    x-on:click="loadWidget(widget.path, client.referralCode)"
                                ></button>
                            </div>
                        </template>
                    </div>
                    <template x-if="client.showReferralCodeInput">
                        <label for="referralCode" class="block text-gray-700 text-sm font-bold mb-2 text-left">
                            Enter referral code
                            <br />
                            <small class="hidden lg:inline">
                                Click on a widget button to load with referral code entered
                            </small>
                        </label>
                        <input id="referralCode" type="text" x-model="client.referralCode" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"/>
                    </template>
                </div>
            </template>
        </div>
        <div class="col-span-3">
            <iframe src="tmc/InstantQuote.html" width="100%" class="h-screen" id="widget-preview"></iframe>
        </div>
    </div>
    <script>
        function loadWidget(widgetPath, referralCode) {
            var url = widgetPath;

            if (url && referralCode) {
                url += '?referral_code=' + referralCode;
                Toastify({
                    text: "Widget loaded with referral code: " + referralCode,
                    duration: 10000,
                }).showToast();
            }

            document.getElementById('widget-preview').src = url;
        }

        function getData() {
            return {
                clients: [
                    {
                        code: 'USD',
                        name: 'Altour',
                        widgets: [
                            {
                                name: 'Instant Quote',
                                path: 'alt/InstantQuote.html',
                                classes: 'bg-blue-500 hover:bg-blue-700',
                            },
                            {
                                name: 'Live Rate Board',
                                path: 'alt/LiveRateBoard.html',
                                classes: 'bg-green-500 hover:bg-green-700',
                            },
                            {
                                name: 'Rate Comparison',
                                path: 'alt/RateComparison.html',
                                classes: 'bg-orange-500 hover:bg-orange-700',
                            },
                        ]
                    },
                    {
                        code: 'BHT',
                        name: 'Barrhead',
                        widgets: [
                            {
                                name: 'Instant Quote',
                                path: 'bht/InstantQuote.html',
                                classes: 'bg-blue-500 hover:bg-blue-700',
                            },
                        ]
                    },
                    {
                        code: 'CRU',
                        name: 'Cruise1st',
                        widgets: [
                            {
                                name: 'Instant Quote',
                                path: 'cru/InstantQuote.html',
                                classes: 'bg-blue-500 hover:bg-blue-700',
                            },
                        ]
                    },
                    {
                        code: 'EXC',
                        name: 'Exchngr',
                        widgets: [
                            {
                                name: 'Instant Quote',
                                path: 'exc/InstantQuote.html',
                                classes: 'bg-blue-500 hover:bg-blue-700',
                            },
                            {
                                name: 'Live Rate Board',
                                path: 'exc/LiveRateBoard.html',
                                classes: 'bg-green-500 hover:bg-green-700',
                            },
                            {
                                name: 'Rate Comparison',
                                path: 'exc/RateComparison.html',
                                classes: 'bg-orange-500 hover:bg-orange-700',
                            },
                        ]
                    },
                    {
                        code: 'TCT',
                        name: 'Thomas Cook',
                        widgets: [
                            {
                                name: 'Instant Quote',
                                path: 'tct/InstantQuote.html',
                                classes: 'bg-blue-500 hover:bg-blue-700',
                            },
                            {
                                name: 'Rate Comparison',
                                path: 'tct/RateComparison.html',
                                classes: 'bg-orange-500 hover:bg-orange-700',
                            },
                        ]
                    },
                    {
                        code: 'TMC',
                        name: 'Travel Money Club',
                        showReferralCodeInput: true,
                        widgets: [
                            {
                                name: 'Instant Quote',
                                path: 'tmc/InstantQuote.html',
                                classes: 'bg-blue-500 hover:bg-blue-700',
                            },
                            {
                                name: 'Live Rate Board',
                                path: 'tmc/LiveRateBoard.html',
                                classes: 'bg-green-500 hover:bg-green-700',
                            },
                            {
                                name: 'Rate Comparison',
                                path: 'tmc/RateComparison.html',
                                classes: 'bg-orange-500 hover:bg-orange-700',
                            },
                        ]
                    },
                    {
                        code: 'VJV',
                        name: 'Jules Verne',
                        widgets: [
                            {
                                name: 'Instant Quote',
                                path: 'vjv/InstantQuote.html',
                                classes: 'bg-blue-500 hover:bg-blue-700',
                            },
                        ]
                    },
                ]
            }
        }
    </script>
</body>
</html>
